<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Health Report | Cattle Vision</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <style>
    body { background: #ffffff; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    .report-header {
      border-bottom: 3px solid #2f7d32;
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    .report-header h2 {
      color: #2f7d32;
      margin: 0;
    }
    .section-title {
      font-size: 1rem;
      font-weight: 600;
      color: #2f7d32;
      margin-top: 16px;
      margin-bottom: 8px;
    }
    .badge-cattle { background-color: #4caf50; }
    .badge-buffalo { background-color: #795548; }
    @media print {
      .btn-print { display: none; }
    }
  </style>
</head>
<body>
  <div class="container my-4">
    <div class="d-flex justify-content-between align-items-center report-header">
      <div>
        <h2>Cattle Vision â€“ Health Report</h2>
        <small class="text-muted">Computer Vision based breed & disease screening</small>
      </div>
      <button class="btn btn-success btn-print" onclick="window.print()">Print</button>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="section-title">Farmer Details</div>
        <p class="mb-1"><strong>Name:</strong> {{ user.name }}</p>
        <p class="mb-1"><strong>Phone:</strong> {{ user.phone or '-' }}</p>
        <p class="mb-1"><strong>Location:</strong> {{ user.location or '-' }}</p>
      </div>
      <div class="col-md-6">
        <div class="section-title">Animal Details</div>
        <p class="mb-1"><strong>Animal ID:</strong> {{ livestock.animal_id }}</p>
        <p class="mb-1">
          <strong>Species:</strong>
          <span class="badge {{ 'badge-buffalo' if livestock.species == 'Buffalo' else 'badge-cattle' }}">
            {{ livestock.species }}
          </span>
        </p>
        <p class="mb-1"><strong>Breed:</strong> {{ livestock.breed }}</p>
        <p class="mb-1">
          <strong>Age:</strong>
          {{ "%.1f"|format(livestock.age_years) if livestock.age_years else '-' }} years
        </p>
      </div>
    </div>

    <div class="section-title">Latest Screening Result</div>
    <table class="table table-bordered align-middle">
      <tbody>
        <tr>
          <th style="width: 30%;">Screening Date & Time</th>
          <td>{{ prediction.analysis_date.strftime('%Y-%m-%d %H:%M') }}</td>
        </tr>
        <tr>
          <th>Predicted Breed</th>
          <td>
            {{ prediction.predicted_breed }}
            {% if prediction.breed_confidence is not none %}
              ({{ "%.1f"|format(prediction.breed_confidence * 100) }}% confidence)
            {% endif %}
          </td>
        </tr>
        <tr>
          <th>Disease Detection</th>
          <td>
            {{ prediction.predicted_disease or 'No disease detected by model' }}
            {% if prediction.disease_confidence is not none %}
              ({{ "%.1f"|format(prediction.disease_confidence * 100) }}% confidence)
            {% endif %}
          </td>
        </tr>
        <tr>
          <th>Health Status</th>
          <td>{{ prediction.health_status or 'Not specified' }}</td>
        </tr>
        <tr>
          <th>System Notes</th>
          <td>{{ prediction.notes or 'No additional notes recorded.' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="section-title">Important Disclaimer</div>
    <p class="small text-muted">
      This report is generated by an AI-based screening system using cattle images. It is only an
      early warning and educational tool and must not be considered a final diagnosis. Farmers
      and FLWs should always consult a qualified veterinarian before treatment or major decisions.
    </p>
  </div>
</body>
</html>
